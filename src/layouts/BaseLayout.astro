---
import "../styles/global.css";

const {
  title = "Yu Zhang — AI for Drug Discovery",
  description = "Yu Zhang, Ph.D. — AI for drug discovery with a focus on safety-aware modeling, antibiotic discovery, and practical ML systems that connect large-scale screening to experimental validation.",
  author = "Yu Zhang",
  ogImage = "/og/og.png",
  ogImageAlt = "Yu Zhang — AI for Drug Discovery",
  ogType = "website",
} = Astro.props;

const SITE = "https://yuzhang-io.github.io";

const canonicalUrl = new URL(Astro.url.pathname, SITE).toString();
const ogImageUrl = new URL(ogImage, SITE).toString();

const ogImageType =
  ogImage.endsWith(".png") ? "image/png" :
  ogImage.endsWith(".jpg") || ogImage.endsWith(".jpeg") ? "image/jpeg" :
  undefined;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>{title}</title>
    <link rel="canonical" href={canonicalUrl} />
    <link rel="icon" href="/favicon.svg" type="image/svg+xml" />

    <meta name="description" content={description} />
    <meta name="author" content={author} />
    <meta name="robots" content="index,follow" />

    <!-- Open Graph -->
    <meta property="og:site_name" content={author} />
    <meta property="og:type" content={ogType} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:url" content={canonicalUrl} />
    <meta property="og:image" content={ogImageUrl} />
    {ogImageType ? <meta property="og:image:type" content={ogImageType} /> : null}
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:image:alt" content={ogImageAlt} />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={ogImageUrl} />
    <meta name="twitter:image:alt" content={ogImageAlt} />
  </head>

  <body class="min-h-screen bg-white text-zinc-900 dark:bg-zinc-950 dark:text-zinc-100">
    <header class="sticky top-0 z-50 border-b border-zinc-200/70 bg-white/80 backdrop-blur dark:border-zinc-800/70 dark:bg-zinc-950/70">
      <div class="mx-auto max-w-5xl px-5 py-3 flex items-center justify-between">
        <a href="/" class="flex items-center gap-2 font-semibold tracking-tight">
          <img src="/img/logo.svg" alt="Yu Zhang" class="h-5 w-5" />
          <span>Yu Zhang</span>
        </a>

        <!-- Desktop nav -->
        <nav class="hidden sm:flex text-sm gap-4 text-zinc-600 dark:text-zinc-300">
          <a class="hover:text-zinc-900 dark:hover:text-white" href="/research">Research</a>
          <a class="hover:text-zinc-900 dark:hover:text-white" href="/publications">Publications</a>
          <a class="hover:text-zinc-900 dark:hover:text-white" href="/software">Software</a>
          <a class="hover:text-zinc-900 dark:hover:text-white" href="/hiking">Hiking</a>
          <a class="hover:text-zinc-900 dark:hover:text-white" href="/Yu_Zhang_CV.pdf">CV</a>
        </nav>

        <!-- Mobile menu button -->
        <button
          id="navToggle"
          type="button"
          class="sm:hidden inline-flex items-center justify-center rounded-xl border border-zinc-200 bg-white/70 px-3 py-2 text-sm font-medium text-zinc-700 shadow-sm backdrop-blur hover:bg-white dark:border-zinc-800 dark:bg-zinc-950/60 dark:text-zinc-200 dark:hover:bg-zinc-950"
          aria-haspopup="true"
          aria-expanded="false"
          aria-controls="mobileNav"
        >
          Menu
          <span aria-hidden="true" class="ml-2">☰</span>
        </button>
      </div>

      <!-- Mobile dropdown -->
      <div id="mobileNav" class="sm:hidden hidden border-t border-zinc-200/70 dark:border-zinc-800/70">
        <nav class="mx-auto max-w-5xl px-5 py-3 grid gap-1 text-sm text-zinc-700 dark:text-zinc-200">
          <a class="rounded-xl px-3 py-2 hover:bg-zinc-100 dark:hover:bg-zinc-900/40" href="/research">Research</a>
          <a class="rounded-xl px-3 py-2 hover:bg-zinc-100 dark:hover:bg-zinc-900/40" href="/publications">Publications</a>
          <a class="rounded-xl px-3 py-2 hover:bg-zinc-100 dark:hover:bg-zinc-900/40" href="/software">Software</a>
          <a class="rounded-xl px-3 py-2 hover:bg-zinc-100 dark:hover:bg-zinc-900/40" href="/hiking">Hiking</a>
          <a class="rounded-xl px-3 py-2 hover:bg-zinc-100 dark:hover:bg-zinc-900/40" href="/Yu_Zhang_CV.pdf">CV</a>
        </nav>
      </div>

      <script is:inline>
        (function () {
          var btn = document.getElementById("navToggle");
          var panel = document.getElementById("mobileNav");
          if (!btn || !panel) return;

          function setOpen(open) {
            panel.classList.toggle("hidden", !open);
            btn.setAttribute("aria-expanded", open ? "true" : "false");
          }

          btn.addEventListener("click", function () {
            var open = panel.classList.contains("hidden");
            setOpen(open);
          });

          // close on route click
          panel.addEventListener("click", function (e) {
            var a = e.target && e.target.closest ? e.target.closest("a") : null;
            if (a) setOpen(false);
          });

          // close on escape
          window.addEventListener("keydown", function (e) {
            if (e.key === "Escape") setOpen(false);
          });
        })();
      </script>
    </header>

    <main class="mx-auto max-w-5xl px-5 py-10">
      <slot />
    </main>

    <footer class="mx-auto max-w-5xl px-5 pb-10 text-sm text-zinc-500 dark:text-zinc-400">
      <div class="border-t border-zinc-200 pt-6 dark:border-zinc-800">
        © {new Date().getFullYear()} Yu Zhang · Built with Astro + Tailwind
      </div>
    </footer>
  </body>
</html>